# =================================================================
# SSH Match Block: Restrict appmgr to CI/GitOps only
# =================================================================
# Copy to: /etc/ssh/sshd_config.d/99-appmgr-ci.conf
# Test: sudo sshd -t
# Apply: sudo systemctl reload ssh
#
# This relies on:
#   - /usr/local/sbin/hosting-ci-ssh (ForceCommand wrapper)
#   - /usr/local/sbin/hosting-deploy (root-owned deploy tool via sudo)
#
# Result:
# - appmgr cannot get an interactive shell
# - appmgr cannot port-forward / agent-forward / X11
# - appmgr can only run "hosting <subcmd> <env> [...]"
# =================================================================

Match User appmgr
  ForceCommand /usr/local/sbin/hosting-ci-ssh
  PermitTTY no
  X11Forwarding no
  AllowAgentForwarding no
  AllowTcpForwarding no
  PermitTunnel no
  PermitUserEnvironment no

